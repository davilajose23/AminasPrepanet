<!DOCTYPE html>
<html>
<head>
	<!--Import Google Icon Font-->
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<!--Import materialize.css-->
	<link type="text/css" rel="stylesheet" href="css/materialize.min.css"  media="screen,projection"/>

	<link type="text/css" rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/animate.min.css">

	<!--Let browser know website is optimized for mobile-->
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<meta charset="UTF-8">
	<title>Aminas Quiz</title>
	<link rel="shortcut icon" href="img/icono.png"/>
</head>

<body class="grey lighten-4">

	<div class="navbar-fixed">
		<nav>
			<div class="nav-wrapper blue-navbar">
				<a href="#!" class="brand-logo left hide-on-med-and-down"><img class="responsive-img center" src="img/logo.png" width="250px"></a>
		        <a href="#!" class="brand-logo right hide-on-med-and-down"><img class="responsive-img " src="img/logoPrepanet.png" width="230px"></a>
		        <a href="#!" class="brand-logo center"><img class="responsive-img" src="img/logoTecBlanco.png" width="230px"></a>
				<ul class="right hide-on-med-and-down">

				</ul>
			</div>
		</nav>
	</div>
	<div class="container ">
		<div class="row">
			<div class="col s12">
				<ul class="tabs">
					<li class="tab col s3"><a target="_self" href="index.html"><i class="material-icons">home</i>Información</a></li>
					<li class="tab col s3"><a target="_self" href="juegos.html"><i class="material-icons">videogame_asset</i>Juegos</a></li>
					<li class="tab col s3"><a target="_self" class="active" href="quiz.html"><i class="material-icons">assignment</i>Quiz</a></li>
					<!-- <li class="tab col s3"><a target="_self"  href="about.html">Acerca de</a></li> -->
				</ul>
			</div>


			<div id="test2" class="col s12">

				

				<div class="col s12 m12 ">
					<div class="card grey lighten-5 ">
						<div class="card-content  ">
							<form action="#">
								<ol>
									<li>
										<span id = "preguntaQuiz1" class="card-title center"></span>
										<span id = "preguntaQuiz1-img"> <img src=""> </span>
										<p>
											<input name="group1" type="radio" id="bp1r1" />
											<label class = "respuestaP1" for="bp1r1"></label>
											<label for="bp1r1"> <img class="responsive-img-quiz1" src=""> </label>
										</p>

										<p>
											<input name="group1" type="radio" id="bp1r2" />
											<label class = "respuestaP1" for="bp1r2"></label>
											<label for="bp1r2"><img class="responsive-img-quiz1" src=""></label>
										</p>

										<p>
											<input name="group1" type="radio" id="bp1r3" />
											<label class = "respuestaP1" for="bp1r3"></label>
											<label for="bp1r3"><img class="responsive-img-quiz1" src=""></label>
										</p>
										<p>
											<input name="group1" type="radio" id="bp1r4"  />
											<label class = "respuestaP1" for="bp1r4"></label>
											<label for="bp1r4"><img class="responsive-img-quiz1" src=""></label>
										</p>
										<br>
									</li>

									<li>
										<span id = "preguntaQuiz2" class="card-title center"></span>
										<span id = "preguntaQuiz2-img"> <img src=""> </span>
										<p>
											<input name="group2" type="radio" id="bp2r1" />
											<label class = "respuestaP2" for="bp2r1"></label>
											<label for="bp2r1"> <img class="responsive-img-quiz2" src=""> </label>
										</p>

										<p>
											<input name="group2" type="radio" id="bp2r2" />
											<label class = "respuestaP2" for="bp2r2"></label>
											<label for="bp2r2"><img class="responsive-img-quiz2" src=""></label>
										</p>

										<p>
											<input name="group2" type="radio" id="bp2r3" />
											<label class = "respuestaP2" for="bp2r3"></label>
											<label for="bp2r3"><img class="responsive-img-quiz2" src=""></label>
										</p>
										<p>
											<input name="group2" type="radio" id="bp2r4"  />
											<label class = "respuestaP2" for="bp2r4"></label>
											<label for="bp2r4"><img class="responsive-img-quiz2" src=""></label>
										</p>
										<br>
									</li>
									<li>
										<span id = "preguntaQuiz3" class="card-title center"></span>
										<span id = "preguntaQuiz3-img"> <img src=""> </span>
										<p>
											<input name="group3" type="radio" id="bp3r1" />
											<label class = "respuestaP3" for="bp3r1"></label>
											<label for="bp3r1"> <img class="responsive-img-quiz3" src=""> </label>
										</p>

										<p>
											<input name="group3" type="radio" id="bp3r2" />
											<label class = "respuestaP3" for="bp3r2"></label>
											<label for="bp3r2"><img class="responsive-img-quiz3" src=""></label>
										</p>

										<p>
											<input name="group3" type="radio" id="bp3r3" />
											<label class = "respuestaP3" for="bp3r3"></label>
											<label for="bp3r3"><img class="responsive-img-quiz3" src=""></label>
										</p>
										<p>
											<input name="group3" type="radio" id="bp3r4"  />
											<label class = "respuestaP3" for="bp3r4"></label>
											<label for="bp3r4"><img class="responsive-img-quiz3" src=""></label>
										</p>
										<br>
									</li>
									<li>
										<span id = "preguntaQuiz4" class="card-title center"></span>
										<span id = "preguntaQuiz4-img"> <img src=""> </span>
										<p>
											<input name="group4" type="radio" id="bp4r1" />
											<label class = "respuestaP4" for="bp4r1"></label>
											<label for="bp4r1"> <img class="responsive-img-quiz4" src=""> </label>
										</p>

										<p>
											<input name="group4" type="radio" id="bp4r2" />
											<label class = "respuestaP4" for="bp4r2"></label>
											<label for="bp4r2"><img class="responsive-img-quiz4" src=""></label>
										</p>

										<p>
											<input name="group4" type="radio" id="bp4r3" />
											<label class = "respuestaP4" for="bp4r3"></label>
											<label for="bp4r3"><img class="responsive-img-quiz4" src=""></label>
										</p>
										<p>
											<input name="group4" type="radio" id="bp4r4"  />
											<label class = "respuestaP4" for="bp4r4"></label>
											<label for="bp4r4"><img class="responsive-img-quiz4" src=""></label>
										</p>
										<br>
									</li>
									<li>
										<span id = "preguntaQuiz5" class="card-title center"></span>
										<span id = "preguntaQuiz5-img"> <img src=""> </span>
										<p>
											<input name="group5" type="radio" id="bp5r1" />
											<label class = "respuestaP5" for="bp5r1"></label>
											<label for="bp5r1"> <img class="responsive-img-quiz5" src=""> </label>
										</p>

										<p>
											<input name="group5" type="radio" id="bp5r2" />
											<label class = "respuestaP5" for="bp5r2"></label>
											<label for="bp5r2"><img class="responsive-img-quiz5" src=""></label>
										</p>

										<p>
											<input name="group5" type="radio" id="bp5r3" />
											<label class = "respuestaP5" for="bp5r3"></label>
											<label for="bp5r3"><img class="responsive-img-quiz5" src=""></label>
										</p>
										<p>
											<input name="group5" type="radio" id="bp5r4"  />
											<label class = "respuestaP5" for="bp5r4"></label>
											<label for="bp5r4"><img class="responsive-img-quiz5" src=""></label>
										</p>
										<br>
									</li>
								</ol>
							</form>
							<br>
						</div>
					</div>
				</div>

				<button id="evaluar-quiz" class="btn waves-effect waves-light right green" type="submit" name="action">Evaluar
					<i class="material-icons right">chevron_right</i>
				</button>

			</div>

		</div>

	</div>

	<!--  Import jquery  -->
  	<script src="js/jquery-3.1.0.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/materialize.min.js"></script>

<script>
	// Quiz
	getDataQuiz();
	// Variables quiz
	var preguntasQuiz;
	var numPreguntasQuiz = [];
	var enEsperaQuiz = false;
	var calificacion = 100;
	// (4 respuestas X 5 preguntas)
	var escogidas = [
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0]
		];
	// (4 respuestas X 5 preguntas)
	var respuestas = [
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0]
		];

	// Función que carga las preguntas del .json para el quiz
  function getDataQuiz(){
    $.ajax({
      url: 'data/quiz.json',
      type: 'GET',
      dataType: 'json',
      success: function(data){
        preguntasQuiz = data['preguntas']; // guarda todas las preguntas en la variable preguntasQuiz
        cargarPreguntasQuiz(); // carga una preguntas en el quiz
      },
      error: function(errorMsg){
        console.log("Error en quiz.json"); // muestra error en la consola si no se pudo obtener juego2.json
      }
    });
  }

  function cargarPreguntasQuiz() {
  	for(var i = 0; i < 5; i++) {
	  	// obtiene un numero random para la siguiente pregunta
		var random = Math.floor((Math.random() * preguntasQuiz.length) + 0);
		numPreguntasQuiz[i] = random;
	}

	// TODO: evitar que se repitan
	cargarRespuestas(preguntasQuiz[numPreguntasQuiz[0]], 1);
	cargarRespuestas(preguntasQuiz[numPreguntasQuiz[1]], 2);
	cargarRespuestas(preguntasQuiz[numPreguntasQuiz[2]], 3);
	cargarRespuestas(preguntasQuiz[numPreguntasQuiz[3]], 4);
	cargarRespuestas(preguntasQuiz[numPreguntasQuiz[4]], 5);
  }

  // carga las respuestas para una pregunta dada
  function cargarRespuestas(pregunta, numPregunta) {
  	// agregar la respuesta correcta a la matriz de respuestas
  	respuestas[pregunta.correcta - 1][numPregunta - 1] = 1;
  	// limpiar elementos de la pregunta anterior
	$("#preguntaQuiz"+ numPregunta).html("");
	$( ".respuestaP" + numPregunta).each(function() {
	  $( this ).html( "" );
	});
	$("#preguntaQuiz"+numPregunta+"-img >img").each(function() {
		$( this ).attr('src', '');
	});
	$(".responsive-img-quiz"+numPregunta).each(function() {
		$( this ).attr('src', '');
	});

	// revisar de que tipo son las preguntas y respuestas
	if (pregunta.tipoPregunta == "imagen") {
		$("#preguntaQuiz"+numPregunta+"-img > img").attr('src', 'img/quiz/' + pregunta["pregunta"]);
		for (var i = 1; i <= 4; i++) {
				var resp = "respuesta";
				$(".respuestaP" + numPregunta).eq(i - 1).html(pregunta[resp.concat(i.toString())]);
		}
	} else if (pregunta.tipoPregunta == "texto") {
		$("#preguntaQuiz" + numPregunta).html(pregunta.pregunta);
		if(pregunta.tipoRespuesta == "texto") {
			for (var i = 1; i <= 4; i++) {
				var resp = "respuesta";
				$(".respuestaP" + numPregunta).eq(i - 1).html(pregunta[resp.concat(i.toString())]);
			}
		} else if (pregunta.tipoRespuesta == "imagen") {
			for (var i = 1; i <= 4; i++) {
				var resp = "respuesta";
				$(".responsive-img-quiz" + numPregunta).eq(i - 1).attr('src', 'img/quiz/' + pregunta[resp.concat(i.toString())]);
			}
		}
	}
}


$("#evaluar-quiz").click(function(){
      	evaluarQuiz();
});

function evaluarQuiz() {
	// (4 respuestas X 5 preguntas)
    escogidas = [
	  [0, 0, 0, 0, 0],
	  [0, 0, 0, 0, 0],
	  [0, 0, 0, 0, 0],
	  [0, 0, 0, 0, 0]
	];

	// se revisa el valor de cada radiobutton para cada pregunta
	// si esta prendida se pone 1 en la casilla de la matriz
	for( var i = 0; i < 5; i++) {
		var radios = document.getElementsByName( "group" +  (i+1).toString());
		for ( var j = 0; j < 4; j++) {
			if(radios[j].checked) {
				escogidas[j][i] = 1;
			}
		}
	}

	// se comparan las matrices de respuestas con la de escogidas
	var equivocada = false;
	for(var i = 0; i < 5; i++) {
		for(var j = 0; j < 4; j++) {
			if(escogidas[j][i] != respuestas[j][i]) {
				equivocada = true;
			}
		}
		if(equivocada) {
			calificacion -= 20;
			equivocada = false;
		}
	}
	alert(calificacion);

	resetQuiz();
}

function resetQuiz() {

	calificacion = 100;
	
	escogidas = [
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0]
		];
	respuestas = [
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0],
		  [0, 0, 0, 0, 0]
		];

	// se apagan los radiobuttons
   for( var i = 0; i < 5; i++) {
		var radios = document.getElementsByName( "group" +  (i+1).toString());
		for ( var j = 0; j < 4; j++) {
			radios[j].checked = false;
		}
	}
	cargarPreguntasQuiz();
}

</script>


</body>
</html>